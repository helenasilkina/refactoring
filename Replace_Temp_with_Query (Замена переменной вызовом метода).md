Замена переменной вызовом метода

Проблема: Вы помещаете результат какого-то выражения в локальную переменную, чтобы использовать её далее в коде.

Решение: Выделите все выражение в отдельный метод и возвращайте результат из него. Замените использование вашей переменной вызовом метода. Новый метод может быть использован и в других методах.

Причины рефакторинга

1. Применение данного рефакторинга может быть подготовительным этапом для применения выделения метода для какой-то части очень длинного метода.
2. Кроме того, иногда можно найти это же выражение и в других методах, что заставляет задуматься о создании общего метода для его получения.

Достоинства

1. Улучшает читабельность кода. Намного проще понять, что делает метод getTax() чем строка orderPrice() * -2.
2. Помогает убрать дублирование кода, если заменяемая строка используется более чем в одном методе.

Полезные факты

Вопрос производительности

1. При использовании этого рефакторинга может возникнуть вопрос, не скажется ли результат рефакторинга не лучшим образом на производительности программы. Честный ответ — да, результирующий код может получить дополнительную нагрузку за счёт вызова нового метода. Однако в наше время быстрых процессоров и хороших компиляторов такая нагрузка вряд ли будет заметна. Зато взамен мы получаем лучшую читабельность кода и возможность использовать новый метод в других местах программы.
2. Тем не менее, если ваша временная переменная служит для кеширования результата действительно трудоёмкого выражения, имеет смысл остановить этот рефакторинг после выделения выражения в новый метод.

Порядок рефакторинга

1. Убедитесь, что переменной в пределах метода присваивается значение только один раз. Если это не так, используйте <a href="https://github.com/helenasilkina/refactoring/blob/master/Split_Temporary_Variable%20(Расщепление%20переменной).md">расщепление переменной</a> для того, чтобы гарантировать, что переменная будет использована только для хранения результата вашего выражения.
2. Используйте <a href="https://github.com/helenasilkina/refactoring/blob/master/Extract_Method%20(Извлечение%20метода).md">извлечение метода</a> для того, чтобы переместить интересующее вас выражение в новый метод. Убедитесь, что этот метод только возвращает значение и не меняет состояние объекта. Если он как-то влияет на видимое состояние объекта, используйте <a href="https://github.com/helenasilkina/refactoring/blob/master/Separate%20Query%20from%20Modifier%20(Разделение%20запроса%20и%20модификатора).md">разделение запроса и модификатора</a>.
3. Замените использование переменной вызовом вашего нового метода.
